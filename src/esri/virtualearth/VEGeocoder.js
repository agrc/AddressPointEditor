//>>built
define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/has","esri/kernel","esri/urlUtils","esri/tasks/Task","esri/virtualearth/VEGeocodeResult","esri/deferredUtils","esri/request"],function(i,b,j,k,q,r,l,m,n,o,p){return i(m,{declaredClass:"esri.virtualearth.VEGeocoder",constructor:function(a){try{if(a=b.mixin({bingMapsKey:null},a||{}),this.url="http://serverapi.arcgisonline.com/veadaptor/production/services/geocode/geocode",this._url=l.urlToObject(this.url),this._queue=
[],this.bingMapsKey=a.bingMapsKey,this.culture=a.culture||"en-US",this._errorHandler=b.hitch(this,this._errorHandler),this._addressToLocationsHandler=b.hitch(this,this._addressToLocationsHandler),!this.bingMapsKey)throw Error("BingMapsKey must be provided.");}catch(c){throw this.onError(c),c;}},addressToLocations:function(a,c,d){if(this.bingMapsKey){var g=b.mixin({},this._url.query,{query:a,token:this.bingMapsKey,culture:this.culture}),e=this._addressToLocationsHandler,h=this._errorHandler,f=new k(o._dfdCanceller);
f._pendingDfd=p({url:this._url.path,content:g,callbackParamName:"callback",load:function(a,b){e(a,b,c,d,f)},error:function(a){h(a,d,f)}});return f}console.debug("Server token not retrieved. Queing request to be executed after server token retrieved.");this._queue.push(arguments)},_addressToLocationsHandler:function(a,b,d,g,e){try{j.forEach(a,function(b,c){a[c]=new n(b)}),this._successHandler([a],"onAddressToLocationsComplete",d,e)}catch(h){this._errorHandler(h,g,e)}},onAddressToLocationsComplete:function(){},
setBingMapsKey:function(a){this.bingMapsKey=a},setCulture:function(a){this.culture=a}})});