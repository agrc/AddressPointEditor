//>>built
define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/request","esri/SpatialReference","esri/geometry/Extent","esri/layers/LayerInfo"],function(b,d,h,l,m,e,i,j,f,k){return b(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",constructor:function(){this.layerInfos=[];var a=this._params={},c=this._url.query?this._url.query.token:null;if(c)a.token=c},_load:function(){i({url:this._url.path,content:d.mixin({f:"json"},this._params),callbackParamName:"callback",
load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(a){try{this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();this.description=a.description;this.copyright=a.copyrightText;this.spatialReference=a.spatialReference&&new j(a.spatialReference);this.initialExtent=a.initialExtent&&new f(a.initialExtent);this.fullExtent=a.fullExtent&&new f(a.fullExtent);this.units=a.units;
this.maxRecordCount=a.maxRecordCount;this.maxImageHeight=a.maxImageHeight;this.maxImageWidth=a.maxImageWidth;this.supportsDynamicLayers=a.supportsDynamicLayers;var c=this.layerInfos=[],b=a.layers,g=this._defaultVisibleLayers=[];h.forEach(b,function(a,b){c[b]=new k(a);a.defaultVisibility&&g.push(a.id)});if(!this.visibleLayers)this.visibleLayers=g;this.version=a.currentVersion;if(!this.version)this.version="capabilities"in a||"tables"in a?10:"supportedImageFormatTypes"in a?9.31:9.3;this.capabilities=
a.capabilities;e.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);e.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale)}catch(d){this._errorHandler(d)}}})});